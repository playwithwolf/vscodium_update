# VSCodium æ›´æ–°æœåŠ¡å™¨ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ æœåŠ¡å™¨æ“ä½œ

### å¯åŠ¨æœåŠ¡å™¨
```bash
cd /path/to/vscodium_update
npm start                    # å¼€å‘æ¨¡å¼
pm2 start ecosystem.config.js  # ç”Ÿäº§æ¨¡å¼
```

### æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
```bash
curl http://localhost:3000/health
curl http://your-server:3000/versions
```

## ğŸ“¦ ç‰ˆæœ¬ç®¡ç†

### ä¸Šä¼ æ–°ç‰ˆæœ¬ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼‰
```bash
# åŸºæœ¬ä¸Šä¼ 
node upload-script.js win32 1.0.1 /path/to/VSCodium-Setup-1.0.1.exe

# ä½¿ç”¨è‡ªå®šä¹‰ä¸‹è½½åœ°å€
node upload-script.js win32 1.0.1 /path/to/file.exe -d https://cdn.com/releases

# ä¸ºç‰¹å®šæ–‡ä»¶æŒ‡å®š URL
node upload-script.js win32 1.0.1 /path/to/file.exe -c file.exe=https://cdn.com/file.exe
```

## ğŸŒ CDN é…ç½®å¿«é€Ÿå‚è€ƒ

### å¹³å°è·¯å¾„è‡ªåŠ¨å¤„ç†
```bash
# ç³»ç»Ÿè‡ªåŠ¨æ·»åŠ å¹³å°è·¯å¾„ï¼Œæ‚¨åªéœ€è®¾ç½®åŸºç¡€åœ°å€
# è®¾ç½®: CUSTOM_DOWNLOAD_URL=https://cdn.example.com/releases
# ç”Ÿæˆ:
# Windows: https://cdn.example.com/releases/win32/file.exe
# macOS:   https://cdn.example.com/releases/darwin/file.dmg
# Linux:   https://cdn.example.com/releases/linux/file.AppImage
```

### CDN é…ç½®æ–¹å¼
```bash
# æ–¹å¼1: ç¯å¢ƒå˜é‡ï¼ˆå…¨å±€é…ç½®ï¼‰
echo "CUSTOM_DOWNLOAD_URL=https://cdn.your-domain.com/releases" >> .env
pm2 restart vscodium-update-server

# æ–¹å¼2: ä¸Šä¼ æ—¶æŒ‡å®šï¼ˆå¹³å°çº§ï¼‰
node upload-script.js win32 1.0.1 /tmp/file.exe -d https://cdn.com/releases

# æ–¹å¼3: æ–‡ä»¶ç‰¹å®šURLï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
node upload-script.js win32 1.0.1 /tmp/file.exe -c file.exe=https://special-cdn.com/file.exe
```

### CDN éƒ¨ç½²æ£€æŸ¥
```bash
# 1. éªŒè¯ä¸‹è½½é“¾æ¥ç”Ÿæˆ
curl "http://localhost:3000/update/win32/1.0.0"

# 2. æµ‹è¯•CDNæ–‡ä»¶è®¿é—®
curl -I "https://cdn.your-domain.com/releases/win32/VSCodium-Setup.exe"

# 3. æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
curl "https://cdn.your-domain.com/releases/win32/file.exe" | sha256sum

# 4. åˆ·æ–°CDNç¼“å­˜ï¼ˆé˜¿é‡Œäº‘ç¤ºä¾‹ï¼‰
aliyun cdn RefreshObjectCaches --ObjectPath https://cdn.your-domain.com/releases/win32/file.exe
```

### æ£€æŸ¥æ›´æ–°
```bash
# æ£€æŸ¥ Windows å¹³å°ä» 1.0.0 åˆ°æœ€æ–°ç‰ˆæœ¬çš„æ›´æ–°
curl "http://localhost:3000/update/win32/1.0.0"

# æ£€æŸ¥æ‰€æœ‰ç‰ˆæœ¬
curl http://localhost:3000/versions
```

## ğŸ”§ VSCodium é…ç½®è¦ç‚¹

### 1. ç‰ˆæœ¬å·è®¾ç½®
```json
// VSCodium/package.json
{
  "version": "1.0.0"  // ä¿®æ”¹è¿™é‡Œ
}
```

### 2. æ›´æ–°æœåŠ¡å™¨é…ç½®
```json
// VSCodium/product.json
{
  "updateUrl": "http://your-server.com:3000"
}
```

### 3. ä¸»è¿›ç¨‹é›†æˆ
```javascript
// åœ¨ VSCodium ä¸»è¿›ç¨‹ä¸­
const { autoUpdater } = require('electron-updater');

autoUpdater.setFeedURL({
  provider: 'generic',
  url: 'http://your-server.com:3000'
});

autoUpdater.checkForUpdatesAndNotify();
```

## ğŸ“ å…³é”®æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `server.js` | ä¸»æœåŠ¡å™¨æ–‡ä»¶ |
| `upload-script.js` | ç‰ˆæœ¬ä¸Šä¼ è„šæœ¬ |
| `versions.json` | ç‰ˆæœ¬ä¿¡æ¯å­˜å‚¨ |
| `releases/` | æ–‡ä»¶å­˜å‚¨ç›®å½• |
| `vscodium-client-example.js` | å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç  |

## ğŸŒ API ç«¯ç‚¹

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/health` | GET | å¥åº·æ£€æŸ¥ |
| `/versions` | GET | è·å–æ‰€æœ‰ç‰ˆæœ¬ |
| `/update/:platform/:version` | GET | æ£€æŸ¥æ›´æ–° |
| `/download/:platform/:filename` | GET | ä¸‹è½½æ–‡ä»¶ |
| `/upload/:platform` | POST | ä¸Šä¼ ç‰ˆæœ¬ |

## âš ï¸ å¸¸è§é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| è¿æ¥å¤±è´¥ | æœåŠ¡å™¨æœªå¯åŠ¨ | æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€ |
| ç‰ˆæœ¬æ ¼å¼é”™è¯¯ | ä¸ç¬¦åˆ semver | ä½¿ç”¨ `1.0.0` æ ¼å¼ |
| ä¸Šä¼ å¤±è´¥ | æƒé™é—®é¢˜ | æ£€æŸ¥ `releases/` ç›®å½•æƒé™ |
| æ›´æ–°ä¸ç”Ÿæ•ˆ | ç‰ˆæœ¬å·ç›¸åŒ | ç¡®ä¿æ–°ç‰ˆæœ¬å·å¤§äºå½“å‰ç‰ˆæœ¬ |

## ğŸ” è°ƒè¯•å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
pm2 logs vscodium-update-server

# æµ‹è¯•æ›´æ–°æ¥å£
curl -v "http://localhost:3000/update/win32/1.0.0"

# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la releases/win32/

# éªŒè¯ç‰ˆæœ¬ä¿¡æ¯
cat versions.json | jq .
```

## ğŸ“š å®Œæ•´æ–‡æ¡£

- **[VSCodiumé›†æˆè¯¦ç»†æ•™ç¨‹.md](./VSCodiumé›†æˆè¯¦ç»†æ•™ç¨‹.md)** - å®Œæ•´çš„æ­¥éª¤æŒ‡å—
- **[README.md](./README.md)** - API æ–‡æ¡£å’Œé…ç½®è¯´æ˜
- **[å¿«é€Ÿå‚è€ƒ.md](./å¿«é€Ÿå‚è€ƒ.md)** - æœ¬æ–‡æ¡£ï¼Œå¿«é€ŸæŸ¥æ‰¾å‘½ä»¤å’Œé…ç½®